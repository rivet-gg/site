import imgRunLocal from "./images/run-local.png";
import imgRunRemote from "./images/run-remote.png";
import imgServers from "./images/servers.png";

# Example (NodeJS)

## Prerequisites

Before you begin, make sure you have the following:

- [Git](https://git-scm.com/downloads)
- [NodeJS](https://nodejs.org/en)
- Available ports
    - 8080 (client)
    - 7777 (game server)
    - 6420 (Rivet)

## Step 1: Install Rivet CLI

<Tabs>
    <Tab title="Download (Windows, x86)">
        ```sh
        curl -L https://releases.rivet.gg/toolchain/v2.0.0-rc.5/windows_x86_64/rivet.exe.zip -o rivet.exe.zip
        unzip rivet.exe.zip
        ```

        Add the directory containing rivet.exe to your PATH environment variable.
    </Tab>
    <Tab title="Download (macOS, Apple Silicon)">
        ```sh
        curl -L https://releases.rivet.gg/toolchain/v2.0.0-rc.5/macos_arm64/rivet.zip -o rivet.zip
        unzip rivet.zip
        chmod +x rivet
        sudo mv rivet /usr/local/bin/
        ```
    </Tab>
    <Tab title="Download (macOS, Intel)">
        ```sh
        curl -L https://releases.rivet.gg/toolchain/v2.0.0-rc.5/macos_x86_64/rivet.zip -o rivet.zip
        unzip rivet.zip
        chmod +x rivet
        sudo mv rivet /usr/local/bin/
        ```
    </Tab>
    <Tab title="Download (Linux, x86)">
        ```sh
        curl -L https://releases.rivet.gg/toolchain/v2.0.0-rc.5/linux_x86_64/rivet.zip -o rivet.zip
        unzip rivet.zip
        chmod +x rivet
        sudo mv rivet /usr/local/bin/
        ```
    </Tab>
    <Tab title="Build From Source (cargo install)">
        1. [Install Rust](https://rustup.sh)
        2. Install Rivet

            ```sh
            cargo install --git=https://github.com/rivet-gg/toolchain rivet-cli
            ```
    </Tab>
    <Tab title="Build From Source (cargo build)">
        1. [Install Rust](https://rustup.sh)
        2. Install Rivet

            ```sh
            git clone https://github.com/rivet-gg/toolchain.git
            cd packages/cli
            cargo build
            ```
    </Tab>
</Tabs>

## Step 2: Clone the example project

```sh
git clone https://github.com/rivet-gg/toolchain.git
cd toolchain/examples/html5-node
```

## Step 3: Install dependencies & run locally

1. Install dependencies:

    ```sh
    npm install
    ```

2. Start the development server:

    ```sh
    npm run dev
    ```

3. Open [http://127.0.0.1:8080](http://127.0.0.1:8080) in your browser to view the running example. You should see the following:

    <Image src={imgRunLocal}/>

## Step 4: Deploy

To deploy the example to Rivet:

1. Log in to Rivet:

    ```sh
    rivet login
    ```

2. Deploy to production:

    ```sh
    rivet deploy prod
    ```

## Step 5: Connect to deployed version

To connect to the deployed version:

1. Get the backend endpoint:

    ```sh
    rivet backend get-endpoint prod
    ```

    Copy this value to the _Endpoint_ field in the client.

2. Get the current game version:

    ```sh
    rivet backend get-current-version prod
    ```

    Copy this value to the _Game Version_ field in the client.

3. Open the client served by `npm run dev` and use these values to connect to the deployed backend. You should be able to connect to your server like this:

    <Image src={imgRunRemote}/>

## Step 6: View deployed server

Open the [Rivet Hub](https://hub.rivet.gg) and open your game's environment. You'll see your server active under the _Servers_ tab.

<Image src={imgServers}/>
