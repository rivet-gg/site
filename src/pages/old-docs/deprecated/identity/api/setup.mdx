import { CodeGroup, Code } from '@/components/Code';

# ⭐️ setup

## Description

Gets or creates an identity.
Passing an existing identity token in the body refreshes the token.
Temporary Accounts
Until the identity is linked with the Rivet Hub (see `PrepareGameLink`), this identity will be temporary but still behave like all other identities.
This is intended to allow users to play the game without signing up while still having the benefits of having an account. When they are ready to save their account, they should be instructed to link their account (see `PrepareGameLink`).
Storing Token
`identity_token` should be stored in some form of persistent storage. The token should be read from storage and passed to `Setup` every time the client starts.

## Code Examples

<CodeGroup title='Request' tag='POST' label='https://api.rivet.gg/identity/identities'>

```bash {{ "title": "cURL" }}
# Write the request body to body.json before running
curl -X POST -d '@body.json' 'https://api.rivet.gg/identity/identities'
```

```ts
// Create Rivet client
import { RivetClient } from '@rivet-gg/api';
const RIVET = new RivetClient({ token: '[YOUR TOKEN HERE]' });

// Make request
await RIVET.identity.setup({
  // Add your request body here
});
```

</CodeGroup>

## Request Parameters

## Request Body

### `existing_identity_token`

`string`

Documentation at https://jwt.io/

## Response Body

### `game_id`

`string` (required)

### `identity`

`object` (required)

Information about the identity that was just authenticated.

### `identity.account_number`

`integer` (required)

### `identity.avatar_url`

`string` (required)

The URL of this identity's avatar image.

### `identity.awaiting_deletion`

`boolean`

Whether or not this identity is awaiting account deletion. Only visible to when the requestee is
this identity.

### `identity.bio`

`string` (required)

Follows regex ^(?:[^\n\r]+\n?|\n){1,5}$

### `identity.display_name`

`string` (required)

### `identity.external`

`object` (required)

External links for an identity.

### `identity.external.profile`

`string` (required)

A link to this identity's profile page.

### `identity.external.settings`

`string`

A link to the Rivet settings page.

### `identity.follower_count`

`integer` (required)

### `identity.following`

`boolean` (required)

Whether or not the requestee's identity is following this identity.

### `identity.following_count`

`integer` (required)

### `identity.games`

`array<object>` (required)

### `identity.games[*].game`

`object` (required)

### `identity.games[*].game.banner_url`

`string`

The URL of this game's banner image.

### `identity.games[*].game.display_name`

`string` (required)

### `identity.games[*].game.game_id`

`string` (required)

### `identity.games[*].game.logo_url`

`string`

The URL of this game's logo image.

### `identity.games[*].game.name_id`

`string` (required)

A human readable short identifier used to references resources. Different than a `uuid` because this is intended to be human readable. Different than `DisplayName` because this should not include special characters and be short.

### `identity.games[*].stats`

`array<object>` (required)

### `identity.games[*].stats[*].config`

`object` (required)

A game statistic config.

### `identity.games[*].stats[*].config.aggregation`

`string` (required)

A value denoting the aggregation method of a game statistic.

### `identity.games[*].stats[*].config.display_name`

`string` (required)

### `identity.games[*].stats[*].config.format`

`string` (required)

A value denoting the format method of a game statistic.

### `identity.games[*].stats[*].config.icon_id`

`string` (required)

### `identity.games[*].stats[*].config.postfix_plural`

`string`

A string appended to the end of a game statistic's value that is not exactly 1. Example: 45 **dollars**.

### `identity.games[*].stats[*].config.postfix_singular`

`string`

A string appended to the end of a singular game statistic's value. Example: 1 **dollar**.

### `identity.games[*].stats[*].config.prefix_plural`

`string`

A string prepended to the beginning of a game statistic's value that is not exactly 1. Example: **values** 45.

### `identity.games[*].stats[*].config.prefix_singular`

`string`

A string appended to the beginning of a singular game statistic's value. Example: **value** 1.

### `identity.games[*].stats[*].config.priority`

`integer` (required)

### `identity.games[*].stats[*].config.record_id`

`string` (required)

### `identity.games[*].stats[*].config.sorting`

`string` (required)

A value denoting the sorting method of a game statistic.

### `identity.games[*].stats[*].overall_value`

`number` (required)

A single overall value of the given statistic.

### `identity.groups`

`array<object>` (required)

### `identity.groups[*].group`

`object` (required)

A group handle.

### `identity.groups[*].group.avatar_url`

`string`

The URL of this group's avatar image

### `identity.groups[*].group.display_name`

`string` (required)

### `identity.groups[*].group.external`

`object` (required)

External links for this group.

### `identity.groups[*].group.external.profile`

`string` (required)

A link to this group's profile page.

### `identity.groups[*].group.group_id`

`string` (required)

### `identity.groups[*].group.is_developer`

`boolean`

Whether or not this group is a developer group.

### `identity.identity_id`

`string` (required)

### `identity.is_admin`

`boolean` (required)

Whether or not this identity is an admin.

### `identity.is_following_me`

`boolean` (required)

Whether or not this identity is both following and is followed by the requestee's identity.

### `identity.is_game_linked`

`boolean`

Whether or not this game user has been linked through the Rivet dashboard.

### `identity.is_mutual_following`

`boolean` (required)

### `identity.is_registered`

`boolean` (required)

Whether or not this identity is registered with a linked account.

### `identity.join_ts`

`string` (required)

### `identity.linked_accounts`

`array<object>` (required)

### `identity.linked_accounts[*].access_token`

`object`

An identity's access token identity.

### `identity.linked_accounts[*].access_token.name`

`string` (required)

### `identity.linked_accounts[*].email`

`object`

An identity's linked email.

### `identity.linked_accounts[*].email.email`

`string` (required)

A valid email address

### `identity.presence`

`object`

Information about the identity's current status, party, and active game.

### `identity.presence.game_activity`

`object`

The game an identity is currently participating in.

### `identity.presence.game_activity.game`

`object` (required)

### `identity.presence.game_activity.game.banner_url`

`string`

The URL of this game's banner image.

### `identity.presence.game_activity.game.display_name`

`string` (required)

### `identity.presence.game_activity.game.game_id`

`string` (required)

### `identity.presence.game_activity.game.logo_url`

`string`

The URL of this game's logo image.

### `identity.presence.game_activity.game.name_id`

`string` (required)

A human readable short identifier used to references resources. Different than a `uuid` because this is intended to be human readable. Different than `DisplayName` because this should not include special characters and be short.

### `identity.presence.game_activity.message`

`string` (required)

A short activity message about the current game activity.

### `identity.presence.game_activity.mutual_metadata`

`object`

JSON data seen only by the given identity and their mutual followers.

### `identity.presence.game_activity.public_metadata`

`object`

JSON data seen by anyone.

### `identity.presence.status`

`string` (required)

The current status of an identity. This helps players understand if another player is currently playing or has their game in the background.

### `identity.presence.update_ts`

`string` (required)

### `identity_token`

`string` (required)

Token used to authenticate the identity.
Should be stored somewhere permanent.
Pass this to `rivet.api.identity#Setup$existing_identity_token` next time `rivet.api.identity#Setup` is called.
Token has a 90 day TTL.
This means that if `rivet.api.identity#Setup` is not called again within 90 days, the token will no longer be valid.
If this happens, the user can recover their account through the linking process (see `rivet.api.identity#PrepareGameLink`).
This token should be stored locally and never sent to a server or another device.
If this token is compromised, anyone with access to this token has control of the identity.

### `identity_token_expire_ts`

`string` (required)

If this token is compromised, anyone with access to this token has control of the identity.
