
import { CodeGroup, Code } from '@/components/Code';
import { DocsJsonSchemaViewer } from '@/components/DocsJsonSchemaViewer';

# setup

## Description

Gets or creates an identity.
Passing an existing identity token in the body refreshes the token.
Temporary Accounts
Until the identity is linked with the Rivet Hub (see `PrepareGameLink`), this identity will be temporary but still behave like all other identities.
This is intended to allow users to play the game without signing up while still having the benefits of having an account. When they are ready to save their account, they should be instructed to link their account (see `PrepareGameLink`).
Storing Token
`identity_token` should be stored in some form of persistent storage. The token should be read from storage and passed to `Setup` every time the client starts.


## Code Examples

<CodeGroup title='Request' tag='POST' label='https://api.rivet.gg/identity/identities'>

```bash {{ title: 'cURL' }}
# Write the request body to body.json before running
curl -X POST -d '@body.json' 'https://api.rivet.gg/identity/identities'
```

```ts
// Create Rivet client
import { RivetClient } from '@rivet-gg/api';
const RIVET = new RivetClient({ token: addYourTokenHere });

// Make request
await RIVET.identity.setup({
  // Add your request body here
});
```

</CodeGroup>


## Request Parameters


## Request Body

<DocsJsonSchemaViewer schema={{"type":"object","properties":{"existing_identity_token":{"type":"string","description":"Documentation at https://jwt.io/"}}}} />


## Response Body

<DocsJsonSchemaViewer schema={{"type":"object","properties":{"identity_token":{"type":"string","description":"Token used to authenticate the identity. \nShould be stored somewhere permanent. \nPass this to `rivet.api.identity#Setup$existing_identity_token` next time `rivet.api.identity#Setup` is called. \nToken has a 90 day TTL. \nThis means that if `rivet.api.identity#Setup` is not called again within 90 days, the token will no longer be valid. \nIf this happens, the user can recover their account through the linking process (see `rivet.api.identity#PrepareGameLink`). \nThis token should be stored locally and never sent to a server or another device. \nIf this token is compromised, anyone with access to this token has control of the identity.\n"},"identity_token_expire_ts":{"type":"string","format":"date-time","description":"If this token is compromised, anyone with access to this token has control of the identity.\n"},"identity":{"type":"object","description":"Information about the identity that was just authenticated.\n","properties":{"identity_id":{"type":"string","format":"uuid"},"display_name":{"type":"string"},"account_number":{"type":"integer"},"avatar_url":{"type":"string","description":"The URL of this identity's avatar image."},"presence":{"type":"object","description":"Information about the identity's current status, party, and active game.","properties":{"update_ts":{"type":"string","format":"date-time"},"status":{"type":"string","enum":["online","away","offline"],"description":"The current status of an identity. This helps players understand if another player is currently playing or has their game in the background."},"game_activity":{"type":"object","description":"The game an identity is currently participating in.","properties":{"game":{"type":"object","properties":{"game_id":{"type":"string","format":"uuid"},"name_id":{"type":"string","description":"A human readable short identifier used to references resources. Different than a `uuid` because this is intended to be human readable. Different than `DisplayName` because this should not include special characters and be short."},"display_name":{"type":"string"},"logo_url":{"type":"string","description":"The URL of this game's logo image."},"banner_url":{"type":"string","description":"The URL of this game's banner image."}},"required":["game_id","name_id","display_name"]},"message":{"type":"string","description":"A short activity message about the current game activity."},"public_metadata":{"description":"JSON data seen by anyone."},"mutual_metadata":{"description":"JSON data seen only by the given identity and their mutual followers."}},"required":["game","message"]}},"required":["update_ts","status"]},"is_registered":{"type":"boolean","description":"Whether or not this identity is registered with a linked account."},"external":{"type":"object","description":"External links for an identity.","properties":{"profile":{"type":"string","description":"A link to this identity's profile page."},"settings":{"type":"string","description":"A link to the Rivet settings page."}},"required":["profile"]},"is_admin":{"type":"boolean","description":"Whether or not this identity is an admin."},"is_game_linked":{"type":"boolean","description":"Whether or not this game user has been linked through the Rivet dashboard."},"dev_state":null,"follower_count":{"type":"integer","format":"int64"},"following_count":{"type":"integer","format":"int64"},"following":{"type":"boolean","description":"Whether or not the requestee's identity is following this identity."},"is_following_me":{"type":"boolean","description":"Whether or not this identity is both following and is followed by the requestee's identity."},"is_mutual_following":{"type":"boolean"},"join_ts":{"type":"string","format":"date-time"},"bio":{"type":"string","description":"Follows regex ^(?:[^\\n\\r]+\\n?|\\n){1,5}$"},"linked_accounts":{"type":"array","items":{"type":"object","description":"A union representing an identity's linked accounts.","properties":{"email":{"type":"object","description":"An identity's linked email.","properties":{"email":{"type":"string","description":"A valid email address"}},"required":["email"]},"access_token":{"type":"object","description":"An identity's access token identity.","properties":{"name":{"type":"string"}},"required":["name"]}}}},"groups":{"type":"array","items":{"type":"object","description":"A group that the given identity.","properties":{"group":{"type":"object","description":"A group handle.","properties":{"group_id":{"type":"string","format":"uuid"},"display_name":{"type":"string"},"avatar_url":{"type":"string","description":"The URL of this group's avatar image"},"external":{"type":"object","description":"External links for this group.","properties":{"profile":{"type":"string","description":"A link to this group's profile page."}},"required":["profile"]},"is_developer":{"type":"boolean","description":"Whether or not this group is a developer group."}},"required":["group_id","display_name","external"]}},"required":["group"]}},"games":{"type":"array","items":{"type":"object","description":"A game statistic summary.","properties":{"game":{"type":"object","properties":{"game_id":{"type":"string","format":"uuid"},"name_id":{"type":"string","description":"A human readable short identifier used to references resources. Different than a `uuid` because this is intended to be human readable. Different than `DisplayName` because this should not include special characters and be short."},"display_name":{"type":"string"},"logo_url":{"type":"string","description":"The URL of this game's logo image."},"banner_url":{"type":"string","description":"The URL of this game's banner image."}},"required":["game_id","name_id","display_name"]},"stats":{"type":"array","items":{"type":"object","description":"A game statistic.","properties":{"config":{"type":"object","description":"A game statistic config.","properties":{"record_id":{"type":"string","format":"uuid"},"icon_id":{"type":"string","format":"uuid"},"format":{"type":"string","enum":["integer","float_1","float_2","float_3","duration_minute","duration_second","duration_hundredth_second"],"description":"A value denoting the format method of a game statistic."},"aggregation":{"type":"string","enum":["sum","average","min","max"],"description":"A value denoting the aggregation method of a game statistic."},"sorting":{"type":"string","enum":["desc","asc"],"description":"A value denoting the sorting method of a game statistic."},"priority":{"type":"integer"},"display_name":{"type":"string"},"postfix_singular":{"type":"string","description":"A string appended to the end of a singular game statistic's value. Example: 1 **dollar**."},"postfix_plural":{"type":"string","description":"A string appended to the end of a game statistic's value that is not exactly 1. Example: 45 **dollars**."},"prefix_singular":{"type":"string","description":"A string appended to the beginning of a singular game statistic's value. Example: **value** 1."},"prefix_plural":{"type":"string","description":"A string prepended to the beginning of a game statistic's value that is not exactly 1. Example: **values** 45."}},"required":["record_id","icon_id","format","aggregation","sorting","priority","display_name"]},"overall_value":{"type":"number","format":"double","description":"A single overall value of the given statistic."}},"required":["config","overall_value"]}}},"required":["game","stats"]}},"awaiting_deletion":{"type":"boolean","description":"Whether or not this identity is awaiting account deletion. Only visible to when the requestee is\nthis identity.\n"}},"required":["identity_id","display_name","account_number","avatar_url","is_registered","external","is_admin","follower_count","following_count","following","is_following_me","is_mutual_following","join_ts","bio","linked_accounts","groups","games"]},"game_id":{"type":"string","format":"uuid"}},"required":["identity_token","identity_token_expire_ts","identity","game_id"]}} />

